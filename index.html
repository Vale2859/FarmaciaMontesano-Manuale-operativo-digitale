<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <title>Portale Professionale ‚Äì Farmacia Montesano</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Icone per salvataggio su telefono / desktop -->
  <link rel="apple-touch-icon" sizes="180x180" href="logomedio.jpg" />
  <link rel="icon" type="image/png" sizes="32x32" href="logomedio.jpg" />

  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <!-- =========================
       SCHERMATA LOGIN / REGISTER
       ========================= -->
  <div id="auth" class="auth-screen">
    <div class="auth-card">
      <!-- LOGO -->
      <div class="auth-logo-only">
        <img src="logomedio.jpg"
             alt="Farmacia Montesano"
             class="auth-logo-img" />
      </div>

      <!-- LOGIN -->
      <div id="login-box">
        <h2 class="login-title">Accesso area riservata</h2>

        <label>Email</label>
        <input type="email" id="login-email" placeholder="nome@esempio.it" />

        <label>Password</label>
        <div class="password-row">
          <input type="password" id="login-password" placeholder="Password" />
          <button type="button"
                  class="btn-eye"
                  onclick="togglePassword()"
                  aria-label="Mostra / nascondi password">
            üëÅ
          </button>
        </div>

        <label class="remember-row">
          <input type="checkbox" id="login-remember" />
          Ricordami su questo dispositivo
        </label>

        <button class="btn-primary" onclick="login()">Entra</button>

        <p class="small-text">
          Non hai ancora un account?
          <a href="#" onclick="showRegister(event)">Registrati</a>
        </p>
      </div>

      <!-- REGISTRAZIONE -->
      <div id="register-box" class="hidden">
        <h2 class="login-title">Registrazione</h2>

        <label>Nome e Cognome</label>
        <input type="text" id="reg-name" placeholder="Es. Mario Rossi" />

        <label>Numero di telefono</label>
        <input type="text" id="reg-phone" placeholder="Es. 333 1234567" />

        <label>Email</label>
        <input type="email" id="reg-email" placeholder="nome@esempio.it" />

        <label>Password</label>
        <input type="password" id="reg-password" placeholder="Crea una password" />

        <label>Sei un...</label>
        <select id="reg-role">
          <option value="dipendente">Dipendente</option>
          <option value="cliente">Cliente</option>
        </select>

        <button class="btn-primary" onclick="registerUser()">Crea account</button>

        <p class="small-text">
          Hai gi√† un account?
          <a href="#" onclick="showLogin(event)">Accedi</a>
        </p>
      </div>

      <p id="auth-error" class="error hidden"></p>

      <p class="small-text muted-center">
        L'utilizzo del portale √® riservato al personale e ai clienti autorizzati
        della Farmacia Montesano.
      </p>
    </div>
  </div>

  <!-- =========================
       PORTALE INTERNO
       ========================= -->
  <div id="portal" class="portal hidden">
    <!-- TOPBAR -->
    <header class="topbar">
      <div class="topbar-left">
        <img src="logo-farmacia-montesano.jpg"
             alt="Farmacia Montesano"
             class="topbar-logo-img" />
        <div>
          <div class="topbar-title">Farmacia Montesano</div>
          <div id="topbar-subtitle" class="topbar-subtitle">
            Portale professionale interno
          </div>
        </div>
      </div>

      <div class="topbar-user">
        <div class="user-pill">
          <span id="user-name-display"></span>
          <span id="user-role-display" class="role-badge"></span>
        </div>
        <button class="btn-outline" onclick="goHome()">Home</button>
        <button class="btn-outline" onclick="logout()">Logout</button>
      </div>
    </header>

    <!-- LAYOUT CONTENUTI -->
    <div class="layout">
      <main class="main">
        <!-- =========================
             HOME DIPENDENTI / ADMIN
             ========================= -->
        <section id="home" class="section visible">
          <div class="home-app-wrapper">
            <div class="app-phone">
              <!-- HEADER APP -->
              <div class="app-header">
                <div class="app-header-top">
                  <span class="app-status-pill">FARMACIA APERTA</span>
                  <span class="app-header-time">08:00‚Äì13:00 ¬∑ 15:00‚Äì20:00</span>
                  <span class="app-header-city">Matera</span>
                </div>
                <div class="app-header-title">
                  <span class="app-header-name">Farmacia Montesano</span>
                  <span class="app-header-sub">Portale dipendenti</span>
                </div>
              </div>

              <!-- SCHERMATE INTERNE -->
              <div class="app-screens">
                <!-- SCHERMATA 1: HOME TILE -->
                <div id="screen-home" class="app-screen app-screen-visible">
                  <div class="app-grid">
                    <button class="app-tile app-tile-orange"
                            onclick="showAppScreen('assenze')">
                      <span class="app-tile-icon">üóì</span>
                      <span class="app-tile-text">Assenze</span>
                    </button>

                    <button class="app-tile app-tile-green"
                            onclick="showSection('procedures')">
                      <span class="app-tile-icon">üìÑ</span>
                      <span class="app-tile-text">Procedure</span>
                    </button>

                    <button class="app-tile app-tile-pink"
                            onclick="showSection('messages')">
                      <span class="app-tile-icon">üì£</span>
                      <span class="app-tile-text">Comunicazioni</span>
                    </button>

                    <button class="app-tile app-tile-blue"
                            onclick="showSection('training')">
                      <span class="app-tile-icon">üéì</span>
                      <span class="app-tile-text">Formazione</span>
                    </button>

                    <button class="app-tile app-tile-yellow"
                            onclick="showSection('logistics')">
                      <span class="app-tile-icon">üì¶</span>
                      <span class="app-tile-text">Logistica</span>
                    </button>

                    <button class="app-tile app-tile-purple"
                            onclick="showSection('personal')">
                      <span class="app-tile-icon">üîê</span>
                      <span class="app-tile-text">Area personale</span>
                    </button>

                    <button id="tile-admin"
                            class="app-tile app-tile-teal"
                            onclick="showSection('admin')">
                      <span class="app-tile-icon">üëë</span>
                      <span class="app-tile-text">Admin</span>
                    </button>

                    <button class="app-tile app-tile-grey"
                            onclick="alert('Spazio per future funzioni')">
                      <span class="app-tile-icon">üíä</span>
                      <span class="app-tile-text">Altre funzioni</span>
                    </button>
                  </div>
                </div>

                <!-- SCHERMATA 2: ASSENZE VELOCI -->
                <div id="screen-assenze" class="app-screen">
                  <h3 class="app-section-title">Assenze dipendenti</h3>

                  <div class="absence-form">
                    <label>Data assenza</label>
                    <input type="date" id="abs-date" />

                    <label>Motivo (es. ferie, visita medica‚Ä¶)</label>
                    <input type="text"
                           id="abs-reason"
                           placeholder="Es. Ferie, permesso, visita medica‚Ä¶" />

                    <button class="btn-primary small" onclick="submitAbsence()">
                      Richiedi assenza
                    </button>
                    <p class="small-text" style="margin-top:6px;">
                      In questa versione snelletta le assenze inserite sono
                      considerate <strong>approvate</strong> e visibili a tutti.
                    </p>
                  </div>

                  <div class="absence-list">
                    <h4>Assenze future approvate</h4>
                    <div id="absence-list"></div>
                  </div>
                </div>
              </div>

              <!-- NAVIGAZIONE IN BASSO -->
              <div class="app-bottom-nav">
                <button id="nav-app-home"
                        class="app-nav-btn app-nav-btn-active"
                        onclick="showAppScreen('home')">
                  Home
                </button>
              </div>
            </div>
          </div>
        </section>

        <!-- =========================
             AREA CLIENTI
             ========================= -->
        <section id="client-home" class="section">
          <h2>Area Clienti</h2>
          <p class="subtitle">
            Qui trovi le <strong>promozioni attive</strong> e puoi
            <strong>prenotare un appuntamento</strong> in farmacia.
          </p>

          <div class="two-cols">
            <!-- PROMOZIONI -->
            <div class="card">
              <h3>Promozioni in corso</h3>
              <div id="client-promos" class="list"></div>
            </div>

            <!-- PRENOTA APPUNTAMENTO -->
            <div class="card">
              <h3>Prenota un appuntamento</h3>

              <label>Giorno</label>
              <input type="date" id="client-date" />

              <label>Orario</label>
              <select id="client-time">
                <option value="">Seleziona prima un giorno</option>
              </select>

              <label>Note (opzionale)</label>
              <textarea id="client-note" rows="3"
                placeholder="Es. consulenza sulla terapia, controllo pressione..."></textarea>

              <button class="btn-primary small" style="margin-top:8px;"
                      onclick="clientBookSlot()">
                Conferma prenotazione
              </button>

              <p class="small-text" style="margin-top:8px;">
                Gli orari gi√† occupati da altri clienti risultano
                <strong>disabilitati</strong> nella lista.
              </p>

              <h4 style="margin-top:16px;">Le tue prenotazioni</h4>
              <div id="client-bookings" class="list"></div>
            </div>
          </div>
        </section>

        <!-- =========================
             PROCEDURE
             ========================= -->
        <section id="procedures" class="section">
          <h2>Procedure interne</h2>
          <p class="subtitle">
            Tutte le procedure ufficiali della Farmacia Montesano, sempre aggiornate.
          </p>

          <div class="proc-layout">
            <div class="proc-categories">
              <div class="proc-cat-title">Categorie</div>
              <div id="proc-categories"></div>
            </div>
            <div class="proc-content">
              <div id="proc-list" class="list"></div>
            </div>
          </div>
        </section>

        <!-- =========================
             COMUNICAZIONI
             ========================= -->
        <section id="messages" class="section">
          <h2>Comunicazioni interne</h2>
          <p class="subtitle">
            Messaggi ufficiali dal titolare o dai responsabili.
            Le comunicazioni urgenti sono evidenziate.
          </p>
          <div id="message-list" class="list"></div>
        </section>

        <!-- =========================
             FERIE & PERMESSI (dipendente)
             ========================= -->
        <section id="leave" class="section">
          <h2>Ferie &amp; permessi</h2>
          <p class="subtitle">
            Invia richieste e controlla lo stato di ferie, permessi e recuperi ore.
          </p>

          <div class="two-cols">
            <div class="card">
              <h3>Nuova richiesta</h3>
              <label>Tipo</label>
              <select id="leave-type">
                <option value="ferie">Ferie</option>
                <option value="permesso_orario">Permesso orario</option>
                <option value="permesso_giornata">Permesso giornata</option>
                <option value="recupero_ore">Recupero ore</option>
                <option value="malattia">Malattia</option>
              </select>

              <div class="field-row">
                <div class="field-flex">
                  <label>Data / inizio</label>
                  <input type="date" id="leave-start" />
                </div>
                <div class="field-flex">
                  <label>Data fine (opzionale)</label>
                  <input type="date" id="leave-end" />
                </div>
              </div>

              <label>Note (opzionali)</label>
              <textarea id="leave-note" rows="3"
                placeholder="Es. permesso per visita medica, ferie estive, ecc."></textarea>

              <button class="btn-primary small" style="margin-top:10px;"
                      onclick="sendLeaveRequest()">
                Invia richiesta
              </button>
            </div>

            <div class="card">
              <h3>Le tue richieste</h3>
              <table class="table-simple" id="leave-table">
                <thead>
                  <tr>
                    <th>Data richiesta</th>
                    <th>Tipo</th>
                    <th>Periodo</th>
                    <th>Stato</th>
                  </tr>
                </thead>
                <tbody></tbody>
              </table>
            </div>
          </div>
        </section>

        <!-- =========================
             FORMAZIONE
             ========================= -->
        <section id="training" class="section">
          <h2>Formazione interna</h2>
          <p class="subtitle">
            Appunti su corsi, moduli da leggere, argomenti da ripassare.
          </p>

          <div class="two-cols">
            <div class="card">
              <h3>Moduli consigliati</h3>
              <ul id="training-list" class="bullet-list"></ul>
            </div>
            <div class="card">
              <h3>I tuoi appunti di formazione</h3>
              <textarea id="training-notes" rows="7"
                placeholder="Scrivi qui appunti su corsi, ECM, prodotti da studiare..."></textarea>
              <div class="card-actions-row">
                <button class="btn-primary small" onclick="saveTrainingNotes()">
                  Salva appunti
                </button>
                <span id="training-saved" class="saved-label hidden">Salvato ‚úî</span>
              </div>
            </div>
          </div>
        </section>

        <!-- =========================
             LOGISTICA
             ========================= -->
        <section id="logistics" class="section">
          <h2>Logistica &amp; scadenze</h2>
          <p class="subtitle">
            Riepilogo essenziale per corrieri, ritiri, scadenze e prodotti delicati.
          </p>

          <div class="two-cols">
            <div class="card">
              <h3>Ritiri e consegne</h3>
              <ul id="logistics-couriers" class="bullet-list"></ul>
            </div>
            <div class="card">
              <h3>Scadenze sensibili</h3>
              <ul id="logistics-expiry" class="bullet-list"></ul>
            </div>
          </div>
        </section>

        <!-- =========================
             AREA PERSONALE DIPENDENTE
             ========================= -->
        <section id="personal" class="section">
          <h2>Area personale privata</h2>
          <p class="subtitle">
            Spazio riservato a te. <strong>Il contenuto non √® visibile all'Admin.</strong>
          </p>

          <div class="card">
            <h3>Note personali</h3>
            <textarea id="personal-notes" rows="6"
              placeholder="Note personali, promemoria, obiettivi... visibili solo a te."></textarea>
            <div class="card-actions-row">
              <button class="btn-primary small" onclick="savePersonalNotes()">
                Salva note personali
              </button>
              <span id="personal-notes-saved" class="saved-label hidden">
                Salvato ‚úî
              </span>
            </div>
          </div>

          <div class="card">
            <h3>Documenti personali (solo promemoria)</h3>
            <p class="small-text">
              Non carichiamo file nel sistema, ma puoi elencare qui buste paga, attestati, ecc.
            </p>

            <div class="field-row wrap">
              <div class="field-flex">
                <label>Titolo documento</label>
                <input type="text"
                       id="personal-doc-title"
                       placeholder="Es. Busta paga marzo 2025" />
              </div>
              <div class="field-flex">
                <label>Descrizione / posizione</label>
                <input type="text"
                       id="personal-doc-desc"
                       placeholder="Es. PDF in iCloud / cartellina verde in ufficio..." />
              </div>
            </div>
            <button class="btn-primary small" style="margin-top:8px;"
                    onclick="addPersonalDoc()">
              Aggiungi ai tuoi documenti
            </button>

            <div id="personal-doc-list" style="margin-top:10px;"></div>
          </div>
        </section>

        <!-- =========================
             AREA ADMIN (TITOLARE)
             ========================= -->
        <section id="admin" class="section">
          <h2>Area Admin (titolare)</h2>
          <p class="subtitle">
            Gestione professionale di utenti, procedure, comunicazioni e ferie/permessi.
          </p>

          <div class="admin-grid">
            <div class="card">
              <h3>Gestione utenti</h3>
              <p class="small-text">
                Approva nuove richieste, reimposta password, abilita/disabilita account.
              </p>
              <div id="admin-users"></div>
            </div>

            <div class="card">
              <h3>Nuova comunicazione</h3>
              <label>Titolo</label>
              <input id="admin-msg-title" type="text" />

              <label>Testo</label>
              <textarea id="admin-msg-body" rows="3"></textarea>

              <label>Destinatario</label>
              <select id="admin-msg-target">
                <option value="all">Tutti i dipendenti</option>
              </select>

              <label>Priorit√†</label>
              <select id="admin-msg-priority">
                <option value="normale">Normale</option>
                <option value="alta">Alta</option>
                <option value="urgente">Urgente</option>
              </select>

              <button class="btn-primary small" style="margin-top:10px;"
                      onclick="adminSendMessage()">
                Invia comunicazione
              </button>
            </div>
          </div>

          <!-- DASHBOARD ASSENZE ADMIN -->
          <div class="card">
            <h3>Gestione ferie &amp; permessi</h3>
            <p class="small-text">
              Vista completa delle richieste di ferie/permessi.
              Da qui il titolare pu√≤
              <strong>approvare, rifiutare o cancellare</strong> le richieste,
              e vedere lo storico di ogni dipendente.
            </p>

            <!-- FILTRI -->
            <div class="field-row wrap" style="margin-top: 6px;">
              <div class="field-flex">
                <label>Mese da visualizzare</label>
                <input type="month" id="admin-leave-month" />
              </div>
              <div class="field-flex">
                <label>Filtra per tipo</label>
                <select id="admin-leave-type-filter">
                  <option value="tutti">Tutti i tipi</option>
                  <option value="ferie">Ferie</option>
                  <option value="permesso_orario">Permesso orario</option>
                  <option value="permesso_giornata">Permesso giornata</option>
                  <option value="recupero_ore">Recupero ore</option>
                  <option value="malattia">Malattia</option>
                </select>
              </div>
              <div class="field-flex">
                <label>Ricerca veloce</label>
                <input type="text"
                       id="admin-leave-search"
                       placeholder="Es. malattia, visita, ferie agosto..." />
              </div>
            </div>

            <!-- LAYOUT A 2 COLONNE -->
            <div class="admin-leave-layout">
              <!-- SINISTRA: MESE -->
              <div class="admin-leave-month">
                <h4>Assenze nel mese selezionato</h4>
                <div id="admin-leave-month-list" class="list"></div>
              </div>

              <!-- DESTRA: DIPENDENTI + STORICO -->
              <div class="admin-leave-side">
                <div class="admin-leave-users">
                  <h4>Dipendenti</h4>
                  <div id="admin-leave-users" class="admin-leave-users-list"></div>
                </div>

                <div class="admin-leave-history">
                  <h4 id="admin-leave-history-title">Storico assenze</h4>
                  <div id="admin-leave-history-list" class="list"></div>
                </div>
              </div>
            </div>
          </div>
        </section>
      </main>
    </div>
  </div>

  <script src="script.js"></script>
</body>
</html>
