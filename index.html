<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <title>Portale Farmacia Montesano</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="style.css" />
</head>
<body>

  <!-- SCHERMATA LOGIN / REGISTRAZIONE / RESET -->
  <div id="auth-screen" class="auth-screen">
    <div class="auth-card">
      <h1 class="logo-title">Farmacia Montesano</h1>
      <h2>Accesso Dipendenti</h2>

      <!-- LOGIN -->
      <div id="login-box">
        <label>Email</label>
        <input type="email" id="login-email" placeholder="nome@farmaciamontesano.it" />

        <label>Password</label>
        <input type="password" id="login-password" placeholder="Password" />

        <button class="btn-primary" onclick="login()">Entra</button>

        <p class="small-text">
          Non hai ancora un account?
          <a href="#" onclick="showRegister()">Richiedi accesso</a>
        </p>

        <p class="small-text">
          Hai dimenticato la password?
          <a href="#" onclick="showReset()">Reimposta password</a>
        </p>
      </div>

      <!-- RICHIESTA ACCESSO (registrazione) -->
      <div id="register-box" class="hidden-block">
        <h3>Richiesta di accesso</h3>
        <p class="small-text">
          La tua richiesta sar√† inviata al titolare che dovr√† <strong>approvarla</strong>
          prima di poterti attivare.
        </p>

        <label>Nome e cognome</label>
        <input type="text" id="reg-name" placeholder="Es. Daniela Andrisani" />

        <label>Email</label>
        <input type="email" id="reg-email" placeholder="Email aziendale" />

        <label>Nota per il titolare (opzionale)</label>
        <textarea id="reg-note" rows="3" placeholder="Es. Nuova collaboratrice reparto dermocosmesi‚Ä¶"></textarea>

        <button class="btn-primary" onclick="sendAccessRequest()">Invia richiesta</button>

        <p class="small-text">
          Hai gi√† un account approvato?
          <a href="#" onclick="showLogin()">Torna al login</a>
        </p>
      </div>

      <!-- RESET PASSWORD -->
      <div id="reset-box" class="hidden-block">
        <h3>Reimposta password</h3>

        <label>Email</label>
        <input type="email" id="reset-email" placeholder="Email registrata" />

        <label>Nuova password</label>
        <input type="password" id="reset-password" placeholder="Nuova password" />

        <label>Conferma nuova password</label>
        <input type="password" id="reset-password-confirm" placeholder="Ripeti password" />

        <button class="btn-primary" onclick="resetPassword()">Imposta nuova password</button>

        <p class="small-text">
          Torna al
          <a href="#" onclick="showLogin()">login</a>.
        </p>
      </div>

      <p id="auth-error" class="error-text" style="display:none;"></p>
    </div>
  </div>

  <!-- PORTALE INTERNO (VISIBILE SOLO DOPO LOGIN) -->
  <div id="portal" class="portal hidden">
    <header class="topbar">
      <div>
        <span class="topbar-logo">Farmacia Montesano ‚Äì Portale Interno</span>
      </div>
      <div class="topbar-user">
        <span id="user-name-display"></span>
        <span id="user-role-display" class="role-badge"></span>
        <button class="btn-outline" onclick="logout()">Logout</button>
      </div>
    </header>

    <div class="layout">
      <!-- MENU LATERALE -->
      <aside class="sidebar">
        <button class="nav-btn active" id="nav-home" onclick="showSection('home', this)">üè† Dashboard</button>
        <button class="nav-btn" id="nav-procedures" onclick="showSection('procedures', this)">üìÑ Procedure</button>
        <button class="nav-btn" id="nav-messages" onclick="showSection('messages', this)">üì£ Comunicazioni</button>

        <!-- Visibili solo all'admin -->
        <button class="nav-btn admin-only hidden-block" id="nav-admin-users" onclick="showSection('admin-users', this)">üë• Utenti</button>
        <button class="nav-btn admin-only hidden-block" id="nav-admin-docs" onclick="showSection('admin-docs', this)">üìÇ Documenti</button>
      </aside>

      <!-- CONTENUTO PRINCIPALE -->
      <main class="main">
        <!-- HOME / DASHBOARD -->
        <section id="home" class="section visible">
          <h2 id="home-title">Benvenuto nel Portale Interno</h2>
          <p class="subtitle">
            Qui trovi tutte le <strong>procedure</strong>, le <strong>comunicazioni interne</strong>
            e gli <strong>strumenti di lavoro</strong> della Farmacia Montesano.
          </p>

          <!-- 3 CARDS INTRODUTTIVE -->
          <div class="cards-grid">
            <div class="card">
              <h3>üìÑ Procedure cassa</h3>
              <p>
                Anticipi, ticket, scontrini, gestione POS, sotto cassa‚Ä¶
                Tutto in un unico posto, sempre aggiornato.
              </p>
            </div>

            <div class="card">
              <h3>üì£ Comunicazioni veloci</h3>
              <p>
                Note importanti di giornata: errori da evitare, nuove promo,
                consegne in arrivo, turni extra, ecc.
              </p>
            </div>

            <div class="card">
              <h3>üìÇ Documenti per te</h3>
              <p>
                Procedure, promemoria e file condivisi dal titolare,
                visibili solo ai dipendenti autorizzati.
              </p>
            </div>
          </div>

          <!-- GRID STRUMENTI OPERATIVI -->
          <div class="home-grid">
            <!-- BACHECA DI OGGI (condivisa) -->
            <div class="card tall">
              <h3>üìù Bacheca di oggi (condivisa)</h3>
              <p class="small-muted">
                Messaggi veloci per il collega del turno successivo (promemoria, avvisi, note di reparto).
              </p>
              <textarea id="board-text" rows="6"
                placeholder="Es. Controllare scadenze antibiotici scaffale 3, ricordarsi modulo per il corriere‚Ä¶"></textarea>
              <div class="card-footer">
                <button class="btn-primary small-btn" onclick="saveBoard()">Salva bacheca</button>
                <span id="board-saved" class="saved-label" style="display:none;">Salvato ‚úî</span>
              </div>
            </div>

            <!-- APPUNTI PERSONALI (solo per l'utente) -->
            <div class="card tall">
              <h3>üìö Appunti personali</h3>
              <p class="small-muted">
                Spazio privato: solo tu puoi vedere questi appunti sul tuo dispositivo.
              </p>
              <textarea id="notes-text" rows="6"
                placeholder="Es. Cose da chiedere a Valerio, prodotti da studiare, dubbi sulle procedure‚Ä¶"></textarea>
              <div class="card-footer">
                <button class="btn-primary small-btn" onclick="savePersonalNotes()">Salva appunti</button>
                <span id="notes-saved" class="saved-label" style="display:none;">Salvato ‚úî</span>
              </div>
            </div>

            <!-- DOCUMENTI CONDIVISI CON TE -->
            <div class="card tall">
              <h3>üìÇ Documenti per te</h3>
              <p class="small-muted">
                Documenti approvati dal titolare e assegnati a te o a tutti i dipendenti.
              </p>
              <div id="user-documents" class="docs-list"></div>
            </div>
          </div>
        </section>

        <!-- PROCEDURE -->
        <section id="procedures" class="section">
          <h2>Procedure interne</h2>
          <div id="procedure-list" class="list"></div>
        </section>

        <!-- COMUNICAZIONI -->
        <section id="messages" class="section">
          <h2>Comunicazioni interne</h2>
          <div id="message-list" class="list"></div>
        </section>

        <!-- GESTIONE UTENTI (ADMIN) -->
        <section id="admin-users" class="section">
          <h2>Gestione utenti</h2>

          <div class="admin-grid">
            <div class="card">
              <h3>Richieste di accesso in attesa</h3>
              <div id="requests-list"></div>
            </div>

            <div class="card">
              <h3>Utenti registrati</h3>
              <div id="users-list"></div>
              <p class="small-muted">
                L'utente con ruolo <strong>Admin</strong> sei tu (Valerio) e pu√≤ gestire tutti gli account.
              </p>
            </div>
          </div>
        </section>

        <!-- GESTIONE DOCUMENTI (ADMIN) -->
        <section id="admin-docs" class="section">
          <h2>Documenti e contenuti</h2>

          <div class="card">
            <h3>Nuovo documento</h3>
            <label>Titolo</label>
            <input type="text" id="doc-title" placeholder="Es. Procedura cambio cassa" />

            <label>Contenuto / descrizione</label>
            <textarea id="doc-content" rows="4" placeholder="Testo della procedura o descrizione del file allegato‚Ä¶"></textarea>

            <label>Destinatario</label>
            <select id="doc-target">
              <option value="all">Tutti i dipendenti</option>
            </select>

            <label>
              <input type="checkbox" id="doc-publish" checked />
              Pubblica subito (visibile ai destinatari)
            </label>

            <button class="btn-primary" onclick="createDocument()">Salva documento</button>
            <p class="small-muted">
              Qui salvi il <strong>testo</strong> della procedura o una <strong>nota con link</strong> al file vero (PDF, Word, ecc.).
            </p>
          </div>

          <div class="card">
            <h3>Documenti esistenti</h3>
            <div id="docs-list"></div>
          </div>
        </section>
      </main>
    </div>
  </div>

  <script src="script.js" defer></script>
</body>
</html>
