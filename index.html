<!DOCTYPE html>
<html lang="it">
  <head>
    <meta charset="UTF-8" />
    <title>Portale Professionale ‚Äì Farmacia Montesano</title>
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, viewport-fit=cover"
    />
    <link rel="stylesheet" href="style.css" />
    <script defer src="script.js"></script>
  </head>
  <body>
    <!-- SCHERMATA LOGIN / REGISTRAZIONE -->
    <div id="auth" class="auth-screen">
      <div class="auth-card">
        <div class="auth-logo-only">
          <img
            src="logomedio"
            alt="Farmacia Montesano"
            class="auth-logo-img"
          />
        </div>

        <!-- LOGIN -->
        <div id="login-box">
          <h2 class="login-title">Portale Farmacia Montesano</h2>

          <p class="login-subtitle">
            Accedi al portale interno o all‚Äôarea clienti.
          </p>

          <label for="login-email">Email</label>
          <input
            type="email"
            id="login-email"
            placeholder="nome@farmaciamontesano.it"
          />

          <label for="login-password">Password</label>
          <div class="password-row">
            <input
              type="password"
              id="login-password"
              placeholder="Password"
            />
            <button
              type="button"
              class="btn-eye"
              onclick="togglePassword()"
              aria-label="Mostra / nascondi password"
            >
              üëÅ
            </button>
          </div>

          <button class="btn-primary" onclick="login()">Entra nel portale</button>

          <p class="small-text">
            Sei un nuovo utente?
            <a href="#" onclick="showRegister(event)">Richiedi registrazione</a>
          </p>

          <p id="auth-error" class="error hidden"></p>
        </div>

        <!-- REGISTRAZIONE DIPENDENTI / CLIENTI -->
        <div id="register-box" class="hidden">
          <h2 class="login-title">Richiesta registrazione</h2>

          <label for="reg-role">Sono un</label>
          <select id="reg-role">
            <option value="dipendente">Dipendente</option>
            <option value="cliente">Cliente</option>
          </select>

          <label for="reg-name">Nome e Cognome</label>
          <input
            type="text"
            id="reg-name"
            placeholder="Es. Daniela Andrisani"
          />

          <label for="reg-email">Email</label>
          <input
            type="email"
            id="reg-email"
            placeholder="nome@farmaciamontesano.it"
          />

          <label for="reg-password">Password</label>
          <input type="password" id="reg-password" placeholder="Password" />

          <button class="btn-primary" onclick="registerUser()">
            Invia richiesta
          </button>

          <p class="small-text">
            I dipendenti verranno abilitati dal Titolare.
            I clienti potranno accedere subito alla propria area.
          </p>

          <p class="small-text">
            Hai gi√† un account?
            <a href="#" onclick="showLogin(event)">Torna al login</a>
          </p>

          <p id="auth-error-register" class="error hidden"></p>
        </div>
      </div>
    </div>

    <!-- PORTALE PRINCIPALE -->
    <div id="portal" class="portal hidden">
      <!-- TOPBAR COMUNE -->
      <header class="topbar">
        <div class="topbar-left">
          <div class="topbar-logo">
            <img
              src="logo-farmacia-montesano.jpg"
              alt="Farmacia Montesano"
              class="topbar-logo-img"
            />
          </div>
          <div>
            <div class="topbar-title">Farmacia Montesano</div>
            <div class="topbar-subtitle">
              Portale interno &amp; Area Clienti
            </div>
          </div>
        </div>

        <div class="topbar-user">
          <div class="user-pill">
            <span id="user-name-display">Operatore</span>
            <span id="user-role-display" class="role-badge">Ruolo</span>
          </div>
          <span
            id="topbar-badge-assenze"
            class="topbar-badge hidden-badge"
          ></span>
          <button class="btn-outline" onclick="goHome()">Dashboard</button>
          <button class="btn-outline" onclick="logout()">Esci</button>
        </div>
      </header>

      <!-- PORTALE STAFF (TITOLARE + DIPENDENTI) -->
      <main id="staff-portal" class="staff-main">
        <div class="layout">
          <!-- SIDEBAR -->
          <aside class="sidebar">
            <div class="sidebar-header">
              <div class="sidebar-label">Portale interno</div>
              <div class="sidebar-sub">Titolare &amp; Dipendenti</div>
            </div>

            <nav class="sidebar-nav">
              <button
                class="sidebar-link active"
                onclick="showSection('section-home')"
                data-section="section-home"
              >
                <span>üè†</span> <span>Home</span>
              </button>

              <button
                class="sidebar-link"
                onclick="showSection('section-assenze')"
                data-section="section-assenze"
              >
                <span>üìí</span>
                <span>Assenze</span>
                <span
                  id="badge-sidebar-assenze"
                  class="badge-circle hidden-badge"
                ></span>
              </button>

              <button
                class="sidebar-link"
                onclick="showSection('section-turni')"
                data-section="section-turni"
              >
                <span>üåô</span> <span>Turni farmacie</span>
              </button>

              <button
                class="sidebar-link"
                onclick="showSection('section-procedure')"
                data-section="section-procedure"
              >
                <span>üìÑ</span> <span>Procedure</span>
              </button>

              <button
                class="sidebar-link"
                onclick="showSection('section-comunicazioni')"
                data-section="section-comunicazioni"
              >
                <span>üì£</span> <span>Comunicazioni</span>
              </button>

              <button
                class="sidebar-link"
                onclick="showSection('section-formazione')"
                data-section="section-formazione"
              >
                <span>üéì</span> <span>Formazione</span>
              </button>

              <button
                class="sidebar-link"
                onclick="showSection('section-logistica')"
                data-section="section-logistica"
              >
                <span>üì¶</span> <span>Logistica</span>
              </button>

              <button
                class="sidebar-link"
                onclick="showSection('section-personale')"
                data-section="section-personale"
              >
                <span>üîê</span> <span>Area personale</span>
              </button>

              <!-- Solo titolare -->
              <button
                class="sidebar-link sidebar-link-admin"
                onclick="showSection('section-admin')"
                id="admin-tile"
                data-section="section-admin"
                style="display:none;"
              >
                <span>üëë</span> <span>Titolare</span>
              </button>

              <div class="sidebar-separator"></div>

              <button
                class="sidebar-link"
                onclick="showSection('section-altro')"
                data-section="section-altro"
              >
                <span>üí°</span> <span>Altre funzioni</span>
              </button>
            </nav>

            <div class="sidebar-footer">
              <div class="sidebar-foot-label">Versione portale</div>
              <div class="sidebar-foot-sub">v3 ‚Äì dashboard completa</div>
            </div>
          </aside>

          <!-- CONTENUTO PRINCIPALE -->
          <section class="content">
            <!-- HOME -->
            <section id="section-home" class="section visible">
              <div class="page-header">
                <div>
                  <h2>Dashboard interna</h2>
                  <p class="subtitle">
                    Assenze, turni e strumenti principali sempre in primo piano.
                  </p>
                </div>
                <div class="today-pill" id="home-daytag"></div>
              </div>

              <!-- Riga principale: assenze + turni -->
              <div class="grid-2">
                <!-- Assenze -->
                <div class="card card-hero">
                  <div class="card-hero-header">
                    <div>
                      <div class="chip-label">Assenze</div>
                      <h3>Dipendenti assenti</h3>
                    </div>
                    <span
                      id="badge-home-assenze"
                      class="badge-circle hidden-badge"
                    ></span>
                  </div>
                  <div id="home-abs-summary" class="home-abs-list">
                    <!-- JS -->
                  </div>
                </div>

                <!-- Turni farmacie -->
                <div class="card card-hero card-hero-turni">
                  <div class="card-hero-header">
                    <div>
                      <div class="chip-label">Turni</div>
                      <h3>Farmacie di turno</h3>
                    </div>
                  </div>
                  <div id="home-turni-list" class="home-abs-list">
                    <!-- JS -->
                  </div>
                </div>
              </div>

              <!-- Seconda riga: 3 tile tipo touch -->
              <div class="grid-3">
                <div class="card mini-card">
                  <h3>Procedure rapide</h3>
                  <p class="small-text">
                    Anticipi, POS, sotto cassa, magazzino: tutto aggiornato in
                    un‚Äôunica sezione.
                  </p>
                  <button
                    class="btn-primary small fullwidth"
                    type="button"
                    onclick="showSection('section-procedure')"
                  >
                    Apri procedure
                  </button>
                </div>

                <div class="card mini-card">
                  <h3>Area personale</h3>
                  <p class="small-text">
                    Appunti privati, note lunghe e documenti personali visibili
                    solo a te.
                  </p>
                  <button
                    class="btn-primary small fullwidth"
                    type="button"
                    onclick="showSection('section-personale')"
                  >
                    Vai all‚Äôarea personale
                  </button>
                </div>

                <div class="card mini-card">
                  <h3>Comunicazioni</h3>
                  <div
                    id="home-messages-preview"
                    class="small-text"
                    style="min-height: 32px; margin-bottom: 4px;"
                  >
                    <!-- preview JS -->
                  </div>
                  <button
                    class="btn-primary small fullwidth"
                    type="button"
                    onclick="showSection('section-comunicazioni')"
                  >
                    Apri comunicazioni
                  </button>
                </div>
              </div>
            </section>

            <!-- ASSENZE -->
            <section id="section-assenze" class="section">
              <div class="page-header">
                <div>
                  <h2>Assenze e ferie</h2>
                  <p class="subtitle">
                    Richieste ferie/permessi e calendario assenze approvate.
                  </p>
                </div>
              </div>

              <div class="grid-2">
                <!-- Colonna sinistra: assenze future approvate -->
                <div class="card">
                  <div class="card-header-row">
                    <h3>Assenze gi√† approvate</h3>
                  </div>
                  <div id="assenze-future-list" class="assenze-future-list">
                    <!-- JS -->
                  </div>
                </div>

                <!-- Colonna destra: richiesta + storico -->
                <div class="card">
                  <h3>Nuova richiesta ferie / permesso</h3>

                  <label for="leave-type">Tipo</label>
                  <select id="leave-type">
                    <option value="ferie">Ferie</option>
                    <option value="permesso_giornata">Permesso giornata</option>
                    <option value="permesso_orario">Permesso orario</option>
                    <option value="recupero_ore">Recupero ore</option>
                  </select>

                  <div class="field-row">
                    <div>
                      <label for="leave-start">Dal giorno</label>
                      <input type="date" id="leave-start" />
                    </div>
                    <div>
                      <label for="leave-end">Al giorno (opzionale)</label>
                      <input type="date" id="leave-end" />
                    </div>
                  </div>

                  <div class="field-row">
                    <div>
                      <label for="leave-time-from"
                        >Dalle ore (solo permesso orario)</label
                      >
                      <input type="time" id="leave-time-from" />
                    </div>
                    <div>
                      <label for="leave-time-to">Alle ore</label>
                      <input type="time" id="leave-time-to" />
                    </div>
                  </div>

                  <label for="leave-note">Note per il titolare</label>
                  <textarea
                    id="leave-note"
                    rows="2"
                    placeholder="Es. visita medica, impegno personale‚Ä¶"
                  ></textarea>

                  <button class="btn-primary" onclick="sendLeaveRequest()">
                    Invia richiesta
                  </button>

                  <div class="card inner-card">
                    <h3>Storico richieste</h3>
                    <div class="table-wrapper">
                      <table id="leave-table" class="table-simple">
                        <thead>
                          <tr>
                            <th>Data richiesta</th>
                            <th>Tipo</th>
                            <th>Periodo</th>
                            <th>Stato</th>
                          </tr>
                        </thead>
                        <tbody>
                          <!-- JS -->
                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>
              </div>
            </section>

            <!-- TURNI FARMACIE -->
            <section id="section-turni" class="section">
              <div class="page-header">
                <div>
                  <h2>Turni farmacie</h2>
                  <p class="subtitle">
                    Elenco turni di oggi e dei prossimi giorni.
                  </p>
                </div>
              </div>

              <div class="card">
                <h3>Turni in evidenza</h3>
                <div id="turni-list" class="list">
                  <!-- JS -->
                </div>
              </div>
            </section>

            <!-- PROCEDURE -->
            <section id="section-procedure" class="section">
              <div class="page-header">
                <div>
                  <h2>Procedure operative</h2>
                  <p class="subtitle">
                    Anticipi, ticket, POS, sotto cassa, magazzino‚Ä¶ tutto in un
                    unico posto.
                  </p>
                </div>
              </div>

              <div class="proc-layout">
                <aside class="proc-categories card" id="proc-categories">
                  <!-- categorie via JS -->
                </aside>

                <div class="card" id="proc-list">
                  <!-- procedure via JS -->
                </div>
              </div>
            </section>

            <!-- COMUNICAZIONI -->
            <section id="section-comunicazioni" class="section">
              <div class="page-header">
                <div>
                  <h2>Comunicazioni interne</h2>
                  <p class="subtitle">
                    Note dal titolare, promemoria quotidiani, avvisi importanti.
                  </p>
                </div>
              </div>

              <div class="card" id="message-list">
                <!-- JS -->
              </div>
            </section>

            <!-- FORMAZIONE -->
            <section id="section-formazione" class="section">
              <div class="page-header">
                <div>
                  <h2>Formazione</h2>
                  <p class="subtitle">
                    Argomenti consigliati e spazio per i tuoi appunti di
                    formazione.
                  </p>
                </div>
              </div>

              <div class="grid-2">
                <div class="card">
                  <h3>Argomenti suggeriti</h3>
                  <ul id="training-list" class="bullet-list">
                    <!-- JS -->
                  </ul>
                </div>

                <div class="card">
                  <h3>I miei appunti</h3>
                  <textarea
                    id="training-notes"
                    rows="7"
                    placeholder="Scrivi qui appunti utili, trucchetti di cassa, note sui prodotti‚Ä¶"
                  ></textarea>
                  <div class="card-actions-row">
                    <button
                      class="btn-primary small"
                      type="button"
                      onclick="saveTrainingNotes()"
                    >
                      Salva appunti
                    </button>
                    <span id="training-saved" class="saved-label hidden">
                      Salvato ‚úì
                    </span>
                  </div>
                </div>
              </div>
            </section>

            <!-- LOGISTICA -->
            <section id="section-logistica" class="section">
              <div class="page-header">
                <div>
                  <h2>Logistica e magazzino</h2>
                  <p class="subtitle">
                    Corrieri, resi, controlli frigo e scadenze.
                  </p>
                </div>
              </div>

              <div class="grid-2">
                <div class="card">
                  <h3>Corrieri e resi</h3>
                  <ul id="logistics-couriers" class="bullet-list"></ul>
                </div>

                <div class="card">
                  <h3>Controlli periodici</h3>
                  <ul id="logistics-expiry" class="bullet-list"></ul>
                </div>
              </div>
            </section>

            <!-- AREA PERSONALE -->
            <section id="section-personale" class="section">
              <div class="page-header">
                <div>
                  <h2>Area personale</h2>
                  <p class="subtitle">
                    Appunti e documenti privati visibili solo a te.
                  </p>
                </div>
              </div>

              <div class="grid-2">
                <div class="card">
                  <h3>Appunti rapidi</h3>
                  <textarea
                    id="quick-notes"
                    rows="6"
                    placeholder="To-do, promemoria personali, cose da chiedere al titolare‚Ä¶"
                  ></textarea>
                  <div class="card-actions-row">
                    <button
                      class="btn-primary small"
                      type="button"
                      onclick="saveQuickNotes()"
                    >
                      Salva appunti
                    </button>
                    <span id="quick-saved" class="saved-label hidden">
                      Salvato ‚úì
                    </span>
                  </div>
                </div>

                <div class="card">
                  <h3>Note estese e documenti</h3>
                  <textarea
                    id="personal-notes"
                    rows="6"
                    placeholder="Note pi√π lunghe che vuoi conservare nel tempo."
                  ></textarea>
                  <div class="card-actions-row">
                    <button
                      class="btn-primary small"
                      type="button"
                      onclick="savePersonalNotes()"
                    >
                      Salva note
                    </button>
                    <span
                      id="personal-notes-saved"
                      class="saved-label hidden"
                    >
                      Salvato ‚úì
                    </span>
                  </div>

                  <h3 style="margin-top:12px;">Documenti personali</h3>
                  <div class="field-row">
                    <input
                      type="text"
                      id="personal-doc-title"
                      placeholder="Es. Turni preferiti, schema scaffali‚Ä¶"
                    />
                    <button
                      class="btn-primary small"
                      type="button"
                      onclick="addPersonalDoc()"
                    >
                      Aggiungi
                    </button>
                  </div>
                  <textarea
                    id="personal-doc-desc"
                    rows="2"
                    placeholder="Descrizione breve (opzionale)"
                  ></textarea>

                  <div
                    id="personal-doc-list"
                    class="list"
                    style="margin-top:8px;"
                  ></div>
                </div>
              </div>
            </section>

            <!-- ADMIN (TITOLARE) -->
            <section id="section-admin" class="section">
              <div class="page-header">
                <div>
                  <h2>Area Titolare</h2>
                  <p class="subtitle">
                    Gestione utenti, comunicazioni, ferie e procedure interne.
                  </p>
                </div>
                <div class="chip-label chip-admin">Accesso titolare</div>
              </div>

              <div class="grid-2">
                <div class="card">
                  <h3>Utenti registrati</h3>
                  <div id="admin-users" class="list"></div>
                </div>

                <div class="card">
                  <h3>Nuova comunicazione</h3>
                  <label for="admin-msg-title">Titolo</label>
                  <input
                    type="text"
                    id="admin-msg-title"
                    placeholder="Es. Nuove regole per anticipi"
                  />

                  <label for="admin-msg-body">Testo</label>
                  <textarea
                    id="admin-msg-body"
                    rows="4"
                    placeholder="Scrivi il messaggio da inviare ai dipendenti‚Ä¶"
                  ></textarea>

                  <label for="admin-msg-priority">Priorit√†</label>
                  <select id="admin-msg-priority">
                    <option value="normale">Normale</option>
                    <option value="alta">Alta</option>
                    <option value="urgente">Urgente</option>
                  </select>

                  <label for="admin-msg-target">Destinatari</label>
                  <select id="admin-msg-target">
                    <option value="all">Tutti i dipendenti</option>
                  </select>

                  <button class="btn-primary" onclick="adminSendMessage()">
                    Invia comunicazione
                  </button>
                </div>
              </div>

              <div class="grid-2" style="margin-top:14px;">
                <div class="card">
                  <h3>Richieste ferie / permessi</h3>
                  <div id="admin-leave-list" class="list"></div>
                </div>

                <div class="card">
                  <h3>Gestione procedure</h3>
                  <label for="admin-proc-cat">Categoria</label>
                  <input
                    type="text"
                    id="admin-proc-cat"
                    placeholder="Es. Cassa, Magazzino, Servizi"
                  />

                  <label for="admin-proc-title">Titolo procedura</label>
                  <input
                    type="text"
                    id="admin-proc-title"
                    placeholder="Es. Anticipi ‚Äì i clienti pagano subito"
                  />

                  <label for="admin-proc-body">Testo procedura</label>
                  <textarea
                    id="admin-proc-body"
                    rows="5"
                    placeholder="Scrivi la procedura passo passo‚Ä¶"
                  ></textarea>

                  <button class="btn-primary" onclick="adminSaveProcedure()">
                    Salva procedura
                  </button>

                  <div
                    id="admin-proc-list"
                    class="list"
                    style="margin-top:10px;"
                  ></div>
                </div>
              </div>
            </section>

            <!-- ALTRE FUNZIONI -->
            <section id="section-altro" class="section">
              <div class="page-header">
                <div>
                  <h2>Altre funzioni</h2>
                  <p class="subtitle">
                    Spazio per idee future: scadenzario, e-commerce, report,
                    ecc.
                  </p>
                </div>
              </div>

              <div class="card">
                <p>
                  Qui in futuro possiamo aggiungere:
                </p>
                <ul class="bullet-list">
                  <li>Collegamento diretto al gestionale (solo lettura).</li>
                  <li>
                    Promemoria automatici via email per scadenze importanti.
                  </li>
                  <li>Link rapidi al sito e all‚Äôe-commerce.</li>
                  <li>Dashboard numeriche personalizzate per il titolare.</li>
                </ul>
              </div>
            </section>
          </section>
        </div>
      </main>

      <!-- PORTALE CLIENTI (solo role === 'cliente') -->
      <main id="customer-portal" class="customer-main hidden">
        <div class="customer-hero">
          <div class="customer-hero-content">
            <h1>Area Clienti</h1>
            <p>
              Prenota farmaci, scopri i servizi e rimani in contatto con
              Farmacia Montesano.
            </p>
          </div>
          <div class="customer-hero-info">
            <div>Matera</div>
            <div>08:00‚Äì13:00 ‚Ä¢ 15:00‚Äì20:00</div>
          </div>
        </div>

        <section class="customer-grid-wrapper">
          <div class="customer-grid">
            <button class="customer-card">
              <div class="customer-icon">üìù</div>
              <div class="customer-title">Prenota farmaci</div>
              <div class="customer-text">
                Invia ricetta o elenco prodotti (in futuro: WhatsApp o email).
              </div>
            </button>

            <button class="customer-card">
              <div class="customer-icon">üíä</div>
              <div class="customer-title">Servizi</div>
              <div class="customer-text">
                Autoanalisi, holter, misurazioni, consulenze specialistiche.
              </div>
            </button>

            <button class="customer-card">
              <div class="customer-icon">‚≠ê</div>
              <div class="customer-title">Promozioni</div>
              <div class="customer-text">
                Offerte attive su dermocosmesi, stagionali e tanto altro.
              </div>
            </button>

            <button class="customer-card">
              <div class="customer-icon">üìû</div>
              <div class="customer-title">Contattaci</div>
              <div class="customer-text">
                Un solo pulsante per chiamare o scriverci (da collegare).
              </div>
            </button>

            <button class="customer-card">
              <div class="customer-icon">üí°</div>
              <div class="customer-title">Consigli salute</div>
              <div class="customer-text">
                Articoli brevi e consigli utili per ogni stagione.
              </div>
            </button>

            <button class="customer-card">
              <div class="customer-icon">üåô</div>
              <div class="customer-title">Farmacie di turno</div>
              <div class="customer-text">
                Link alle farmacie di turno notturne e festive.
              </div>
            </button>

            <button class="customer-card">
              <div class="customer-icon">üìÅ</div>
              <div class="customer-title">I miei documenti</div>
              <div class="customer-text">
                In futuro: ricette salvate, promemoria terapie, ecc.
              </div>
            </button>

            <button class="customer-card">
              <div class="customer-icon">üë§</div>
              <div class="customer-title">Profilo</div>
              <div class="customer-text">
                Dati anagrafici e preferenze cliente.
              </div>
            </button>
          </div>

          <p class="customer-footnote">
            L‚ÄôArea Clienti √® pronta graficamente. Ogni card potr√† essere
            collegata a WhatsApp, email, telefono o e-commerce.
          </p>
        </section>
      </main>
    </div>
  </body>
</html>
