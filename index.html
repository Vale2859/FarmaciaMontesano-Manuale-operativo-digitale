<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <title>Portale Professionale ‚Äì Farmacia Montesano</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Icona per tab / scorciatoia (metti il tuo file favicon.png nella stessa cartella) -->
  <link rel="icon" type="image/png" href="favicon.png" />

  <!-- Stili -->
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <!-- ==================== LOGIN / REGISTRAZIONE ==================== -->
  <div id="auth" class="auth-screen">
    <div class="auth-card">
      <!-- Logo -->
      <div class="auth-logo-only">
        <img src="logomedio.jpg" alt="Farmacia Montesano" class="auth-logo-img" />
      </div>

      <!-- BOX LOGIN -->
      <div id="login-box">
        <h2 class="login-title">Accesso al portale</h2>

        <label for="login-email">Email</label>
        <input type="email" id="login-email" placeholder="nome@farmaciamontesano.it" />

        <label for="login-password">Password</label>
        <div class="password-row">
          <input type="password" id="login-password" placeholder="Password" />
          <button type="button" class="btn-eye" onclick="togglePassword()" aria-label="Mostra / nascondi password">üëÅ</button>
        </div>

        <label class="remember-row">
          <input type="checkbox" id="remember-me" />
          <span>Ricordami su questo dispositivo</span>
        </label>

        <button class="btn-primary" onclick="login()">Entra</button>

        <p class="small-text">
          Non hai ancora un account?
          <a href="#" onclick="showRegister(event)">Registrati</a>
        </p>
      </div>

      <!-- BOX REGISTRAZIONE -->
      <div id="register-box" class="hidden">
        <h2 class="login-title">Nuovo account</h2>

        <label for="reg-name">Nome e cognome</label>
        <input type="text" id="reg-name" placeholder="Es. Mario Rossi" />

        <label for="reg-phone">Numero di telefono</label>
        <input type="tel" id="reg-phone" placeholder="Es. 333 1234567" />

        <label for="reg-email">Email</label>
        <input type="email" id="reg-email" placeholder="nome@farmaciamontesano.it" />

        <label for="reg-password">Password</label>
        <input type="password" id="reg-password" placeholder="Crea una password" />

        <label for="reg-role">Sei un...</label>
        <select id="reg-role">
          <option value="cliente">Cliente</option>
          <option value="dipendente">Dipendente</option>
          <option value="admin">Titolare</option>
        </select>

        <button class="btn-primary" onclick="registerUser()">Crea account</button>

        <p class="small-text">
          Hai gi√† un account?
          <a href="#" onclick="showLogin(event)">Torna al login</a>
        </p>
      </div>

      <p id="auth-error" class="error-text hidden"></p>

      <p class="small-text muted-center">
        L'utilizzo del portale √® riservato al personale autorizzato della Farmacia Montesano.
      </p>
    </div>
  </div>

  <!-- ==================== PORTALE INTERNO ==================== -->
  <div id="portal" class="portal hidden">
    <!-- TOPBAR -->
    <header class="topbar">
      <div class="topbar-left">
        <img src="logo-farmacia-montesano.jpg" alt="Farmacia Montesano" class="topbar-logo-img" />
        <div>
          <div class="topbar-title">Farmacia Montesano</div>
          <div id="topbar-subtitle" class="topbar-subtitle">Portale professionale interno</div>
        </div>
      </div>
      <div class="topbar-user">
        <div class="user-pill">
          <span id="user-name-display"></span>
          <span id="user-role-display" class="role-badge"></span>
        </div>
        <button class="btn-outline" onclick="goHome()">Home</button>
        <button class="btn-outline" onclick="logout()">Logout</button>
      </div>
    </header>

    <!-- CONTENUTO -->
    <main class="main">
      <!-- ============ HOME DIPENDENTI ============ -->
      <section id="home-employee" class="section">
        <div class="home-app-wrapper">
          <div class="app-phone">
            <!-- HEADER APP -->
            <div class="app-header">
              <div class="app-header-top">
                <span class="app-status-pill">FARMACIA APERTA</span>
                <span class="app-header-time">08:00‚Äì13:00 ¬∑ 15:00‚Äì20:00</span>
                <span class="app-header-city">Matera</span>
              </div>
              <div class="app-header-title">
                <span class="app-header-name">Farmacia Montesano</span>
                <span class="app-header-sub">Portale dipendenti</span>
              </div>
            </div>

            <!-- SCHERMATE INTERNE APP -->
            <div class="app-screens">
              <!-- HOME TILE -->
              <div id="screen-home" class="app-screen app-screen-visible">
                <div class="app-grid">
                  <button class="app-tile app-tile-orange" onclick="openAbsenceArea()">
                    <span class="app-tile-icon">üóì</span>
                    <span class="app-tile-text">Assenze</span>
                  </button>

                  <button class="app-tile app-tile-green" onclick="showSection('procedures')">
                    <span class="app-tile-icon">üìÑ</span>
                    <span class="app-tile-text">Procedure</span>
                  </button>

                  <button class="app-tile app-tile-pink" onclick="showSection('messages')">
                    <span class="app-tile-icon">üì£</span>
                    <span class="app-tile-text">Comunicazioni</span>
                  </button>

                  <button class="app-tile app-tile-blue" onclick="showSection('training')">
                    <span class="app-tile-icon">üéì</span>
                    <span class="app-tile-text">Formazione</span>
                  </button>

                  <button class="app-tile app-tile-yellow" onclick="showSection('logistics')">
                    <span class="app-tile-icon">üì¶</span>
                    <span class="app-tile-text">Logistica</span>
                  </button>

                  <button class="app-tile app-tile-purple" onclick="showSection('personal')">
                    <span class="app-tile-icon">üîê</span>
                    <span class="app-tile-text">Area personale</span>
                  </button>

                  <button class="app-tile app-tile-teal" onclick="showSection('leave')">
                    <span class="app-tile-icon">üå¥</span>
                    <span class="app-tile-text">Ferie / permessi</span>
                  </button>

                  <button id="tile-admin" class="app-tile app-tile-grey admin-only" onclick="showSection('admin')">
                    <span class="app-tile-icon">üëë</span>
                    <span class="app-tile-text">Area Admin</span>
                  </button>
                </div>
              </div>

              <!-- SCHERMATA ASSENZE DIPENDENTE -->
              <div id="screen-assenze" class="app-screen">
                <h3 class="app-section-title">Assenze dipendenti</h3>

                <div class="absence-form">
                  <label>Data assenza</label>
                  <input type="date" id="abs-date" />

                  <label>Tipo assenza</label>
                  <select id="abs-type">
                    <option value="ferie">Ferie</option>
                    <option value="permesso_orario">Permesso orario</option>
                    <option value="permesso_giornata">Giornata intera</option>
                    <option value="malattia">Malattia</option>
                    <option value="altro">Altro</option>
                  </select>

                  <label>Motivo (es. ferie, visita medica‚Ä¶)</label>
                  <input type="text" id="abs-reason" placeholder="Es. Ferie, permesso, visita medica‚Ä¶" />

                  <button class="btn-primary small" onclick="submitAbsence()">
                    Richiedi assenza
                  </button>
                  <p class="small-text" style="margin-top:6px;">
                    In questa versione tutte le assenze inserite sono considerate
                    <strong>approvate</strong> e visibili a tutti.
                  </p>
                </div>

                <div class="absence-list">
                  <h4>Assenze future approvate</h4>
                  <div id="absence-list"></div>
                </div>
              </div>
            </div>

            <!-- NAVIGAZIONE INFERIORE -->
            <div class="app-bottom-nav">
              <button id="nav-app-home" class="app-nav-btn app-nav-btn-active" onclick="showAppScreen('home')">
                Home
              </button>
              <button id="nav-app-assenze" class="app-nav-btn" onclick="showAppScreen('assenze')">
                Assenze
              </button>
            </div>
          </div>
        </div>
      </section>

      <!-- ============ PROCEDURE ============ -->
      <section id="procedures" class="section">
        <h2>Procedure interne</h2>
        <p class="subtitle">
          Tutte le procedure ufficiali della Farmacia Montesano, sempre aggiornate.
        </p>

        <div class="proc-layout">
          <div class="proc-categories">
            <div class="proc-cat-title">Categorie</div>
            <div id="proc-categories"></div>
          </div>
          <div class="proc-content">
            <div id="proc-list" class="list"></div>
          </div>
        </div>
      </section>

      <!-- ============ COMUNICAZIONI ============ -->
      <section id="messages" class="section">
        <h2>Comunicazioni interne</h2>
        <p class="subtitle">
          Messaggi ufficiali dal titolare o dai responsabili.
        </p>
        <div id="message-list" class="list"></div>
      </section>

      <!-- ============ FERIE & PERMESSI ============ -->
      <section id="leave" class="section">
        <h2>Ferie &amp; permessi</h2>
        <p class="subtitle">
          Invia richieste e controlla lo stato di ferie, permessi e recuperi ore.
        </p>

        <div class="two-cols">
          <div class="card">
            <h3>Nuova richiesta</h3>
            <label>Tipo</label>
            <select id="leave-type">
              <option value="ferie">Ferie</option>
              <option value="permesso_orario">Permesso orario</option>
              <option value="permesso_giornata">Permesso giornata</option>
              <option value="recupero_ore">Recupero ore</option>
            </select>

            <div class="field-row">
              <div>
                <label>Data / inizio</label>
                <input type="date" id="leave-start" />
              </div>
              <div>
                <label>Data fine (opzionale)</label>
                <input type="date" id="leave-end" />
              </div>
            </div>

            <label>Note (opzionali)</label>
            <textarea id="leave-note" rows="3"
              placeholder="Es. permesso per visita medica, ferie estive, ecc."></textarea>

            <button class="btn-primary small" style="margin-top:10px;" onclick="sendLeaveRequest()">
              Invia richiesta
            </button>
          </div>

          <div class="card">
            <h3>Le tue richieste</h3>
            <table class="table-simple" id="leave-table">
              <thead>
                <tr>
                  <th>Data richiesta</th>
                  <th>Tipo</th>
                  <th>Periodo</th>
                  <th>Stato</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
      </section>

      <!-- ============ FORMAZIONE ============ -->
      <section id="training" class="section">
        <h2>Formazione interna</h2>
        <p class="subtitle">
          Appunti su corsi, moduli da leggere, argomenti da ripassare.
        </p>

        <div class="two-cols">
          <div class="card">
            <h3>Moduli consigliati</h3>
            <ul id="training-list" class="bullet-list"></ul>
          </div>
          <div class="card">
            <h3>I tuoi appunti di formazione</h3>
            <textarea id="training-notes" rows="7"
              placeholder="Scrivi qui appunti su corsi, ECM, prodotti da studiare..."></textarea>
            <div class="card-actions-row">
              <button class="btn-primary small" onclick="saveTrainingNotes()">Salva appunti</button>
              <span id="training-saved" class="saved-label hidden">Salvato ‚úî</span>
            </div>
          </div>
        </div>
      </section>

      <!-- ============ LOGISTICA ============ -->
      <section id="logistics" class="section">
        <h2>Logistica &amp; scadenze</h2>
        <p class="subtitle">
          Riepilogo essenziale per corrieri, ritiri, scadenze e prodotti delicati.
        </p>

        <div class="two-cols">
          <div class="card">
            <h3>Ritiri e consegne</h3>
            <ul id="logistics-couriers" class="bullet-list"></ul>
          </div>
          <div class="card">
            <h3>Scadenze sensibili</h3>
            <ul id="logistics-expiry" class="bullet-list"></ul>
          </div>
        </div>
      </section>

      <!-- ============ AREA PERSONALE ============ -->
      <section id="personal" class="section">
        <h2>Area personale privata</h2>
        <p class="subtitle">
          Spazio riservato a te. <strong>Il contenuto non √® visibile all'Admin.</strong>
        </p>

        <div class="card">
          <h3>Note personali</h3>
          <textarea id="personal-notes" rows="6"
            placeholder="Note personali, promemoria, obiettivi... visibili solo a te."></textarea>
          <div class="card-actions-row">
            <button class="btn-primary small" onclick="savePersonalNotes()">Salva note personali</button>
            <span id="personal-notes-saved" class="saved-label hidden">Salvato ‚úî</span>
          </div>
        </div>

        <div class="card">
          <h3>Documenti personali (solo promemoria)</h3>
          <p class="small-text">
            Non carichiamo file nel sistema, ma puoi elencare qui buste paga, attestati, ecc.
          </p>

          <div class="field-row wrap">
            <div class="field-flex">
              <label>Titolo documento</label>
              <input type="text" id="personal-doc-title" placeholder="Es. Busta paga marzo 2025" />
            </div>
            <div class="field-flex">
              <label>Descrizione / posizione</label>
              <input type="text" id="personal-doc-desc"
                placeholder="Es. PDF in iCloud / cartellina verde in ufficio..." />
            </div>
          </div>
          <button class="btn-primary small" style="margin-top:8px;" onclick="addPersonalDoc()">
            Aggiungi ai tuoi documenti
          </button>

          <div id="personal-doc-list" style="margin-top:10px;"></div>
        </div>
      </section>

      <!-- ============ AREA ADMIN ============ -->
      <section id="admin" class="section admin-only">
        <h2>Area Admin (titolare)</h2>
        <p class="subtitle">
          Gestione professionale di utenti, procedure, comunicazioni e ferie.
        </p>

        <div class="admin-grid">
          <div class="card">
            <h3>Gestione utenti</h3>
            <p class="small-text">
              Approva nuove richieste, reimposta password, abilita/disabilita account.
            </p>
            <div id="admin-users"></div>
          </div>

          <div class="card">
            <h3>Nuova comunicazione</h3>
            <label>Titolo</label>
            <input id="admin-msg-title" type="text" />

            <label>Testo</label>
            <textarea id="admin-msg-body" rows="3"></textarea>

            <label>Destinatario</label>
            <select id="admin-msg-target">
              <option value="all">Tutti i dipendenti</option>
            </select>

            <label>Priorit√†</label>
            <select id="admin-msg-priority">
              <option value="normale">Normale</option>
              <option value="alta">Alta</option>
              <option value="urgente">Urgente</option>
            </select>

            <button class="btn-primary small" style="margin-top:10px;" onclick="adminSendMessage()">
              Invia comunicazione
            </button>
          </div>
        </div>

        <div class="card">
          <h3>Procedure ufficiali</h3>
          <p class="small-text">
            Crea o aggiorna procedure. Verranno mostrate nella sezione "Procedure".
          </p>

          <div class="field-row wrap">
            <div class="field-flex">
              <label>Categoria</label>
              <input type="text" id="admin-proc-cat" placeholder="Es. Cassa, Magazzino, Servizi..." />
            </div>
            <div class="field-flex">
              <label>Titolo procedura</label>
              <input type="text" id="admin-proc-title" placeholder="Es. Anticipi ‚Äì i clienti pagano subito" />
            </div>
          </div>

          <label>Testo procedura</label>
          <textarea id="admin-proc-body" rows="4"
            placeholder="Descrivi in modo chiaro tutti i passaggi."></textarea>

          <button class="btn-primary small" style="margin-top:8px;" onclick="adminSaveProcedure()">
            Salva / aggiorna procedura
          </button>

          <div id="admin-proc-list" class="list" style="margin-top:10px;"></div>
        </div>

        <div class="card">
          <h3>Gestione ferie &amp; permessi</h3>
          <p class="small-text">
            Approva o rifiuta le richieste. Lo storico rimane visibile anche ai dipendenti.
          </p>
          <div id="admin-leave-list" class="list"></div>
        </div>
      </section>

      <!-- ============ ASSENZE ‚Äì VISTA TITOLARE ============ -->
      <section id="absences-admin" class="section admin-only">
        <h2>Assenze dipendenti ‚Äì vista Titolare</h2>
        <p class="subtitle">
          Riepilogo mese per mese e storico per singolo dipendente. Da qui puoi
          approvare, rifiutare o cancellare le assenze.
        </p>

        <div class="two-cols">
          <!-- COLONNA SINISTRA: RIEPILOGO MENSILE -->
          <div class="card">
            <h3>Calendario mensile</h3>
            <label>Mese</label>
            <input type="month" id="abs-admin-month" />

            <div id="abs-admin-month-list" class="list" style="margin-top:10px;"></div>
          </div>

          <!-- COLONNA DESTRA: STORICO PER DIPENDENTE -->
          <div class="card">
            <h3>Storico per dipendente</h3>

            <div class="field-row" style="gap:8px; align-items:flex-end;">
              <div class="field-flex">
                <label>Dipendente</label>
                <select id="abs-admin-employee">
                  <option value="">Tutti</option>
                </select>
              </div>

              <div class="field-flex">
                <label>Tipo assenza</label>
                <select id="abs-admin-type-filter">
                  <option value="tutti">Tutti i tipi</option>
                  <option value="ferie">Ferie</option>
                  <option value="permesso_orario">Permesso orario</option>
                  <option value="permesso_giornata">Giornata intera</option>
                  <option value="malattia">Malattia</option>
                  <option value="altro">Altro</option>
                </select>
              </div>
            </div>

            <div id="abs-admin-history" class="list" style="margin-top:10px;"></div>
          </div>
        </div>
      </section>

      <!-- ============ HOME CLIENTI ============ -->
      <section id="home-client" class="section">
        <div class="client-home-wrapper">
          <div class="client-card">
            <div class="client-header">
              <div class="client-header-top">
                <span class="client-badge">BENVENUTO</span>
                <span class="client-header-sub">Servizi online dedicati ai clienti</span>
              </div>
              <div class="client-header-title">
                <div class="client-header-name">Area Clienti</div>
                <div class="client-header-sub2">Farmacia Montesano ¬∑ Matera</div>
              </div>
            </div>

            <div class="client-grid">
              <button class="client-tile client-tile-green" onclick="showClientPanel('booking')">
                <span class="client-icon">üíä</span>
                <span class="client-text">Prenota farmaci</span>
              </button>

              <button class="client-tile client-tile-blue" onclick="showClientPanel('requests')">
                <span class="client-icon">üí¨</span>
                <span class="client-text">Richieste &amp; messaggi</span>
              </button>

              <button class="client-tile client-tile-orange" onclick="showClientPanel('promos')">
                <span class="client-icon">üì£</span>
                <span class="client-text">Promozioni</span>
              </button>

              <button class="client-tile client-tile-purple" onclick="showClientPanel('appointments')">
                <span class="client-icon">üìÖ</span>
                <span class="client-text">Appuntamenti</span>
              </button>

              <button class="client-tile client-tile-teal" onclick="showClientPanel('contacts')">
                <span class="client-icon">üìç</span>
                <span class="client-text">Orari &amp; contatti</span>
              </button>

              <button class="client-tile client-tile-grey" onclick="showClientPanel('soon')">
                <span class="client-icon">‚≠ê</span>
                <span class="client-text">Prossimamente‚Ä¶</span>
              </button>
            </div>

            <!-- PANNELLI INTERNI CLIENTE -->
            <div class="client-panels">
              <!-- default -->
              <div id="client-panel-welcome" class="client-panel client-panel-visible">
                <p>
                  Benvenuto nell‚Äôarea clienti della Farmacia Montesano.
                  Da qui puoi prenotare farmaci, inviare richieste, controllare promozioni
                  e gestire i tuoi appuntamenti.
                </p>
              </div>

              <!-- Prenota farmaci -->
              <div id="client-panel-booking" class="client-panel">
                <h3>Prenota farmaci</h3>
                <p class="small-text">
                  Seleziona giorno e orario preferito. Se l‚Äôorario √® gi√† occupato da un altro cliente
                  ti verr√† chiesto di scegliere una fascia diversa.
                </p>

                <div class="field-row wrap">
                  <div class="field-flex">
                    <label>Data</label>
                    <input type="date" id="client-book-date" />
                  </div>
                  <div class="field-flex">
                    <label>Orario</label>
                    <input type="time" id="client-book-time" />
                  </div>
                </div>

                <label>Note (facoltative)</label>
                <textarea id="client-book-note" rows="3"
                  placeholder="Es. nome del farmaco, prescrizione, preferenze..."></textarea>

                <button class="btn-primary small" style="margin-top:10px;" onclick="clientSubmitBooking()">
                  Invia prenotazione
                </button>

                <p id="client-book-error" class="error-text hidden"></p>

                <div class="card" style="margin-top:14px;">
                  <h4>Orari occupati nel giorno selezionato</h4>
                  <div id="client-book-taken" class="small-text"></div>
                </div>

                <div class="card" style="margin-top:14px;">
                  <h3>Le tue prenotazioni</h3>
                  <div id="client-book-list" class="list"></div>
                </div>
              </div>

              <!-- Richieste -->
              <div id="client-panel-requests" class="client-panel">
                <h3>Richieste &amp; messaggi</h3>
                <p class="small-text">
                  In una versione futura qui potrai inviare messaggi diretti alla farmacia.
                </p>
              </div>

              <!-- Promozioni -->
              <div id="client-panel-promos" class="client-panel">
                <h3>Promozioni attive</h3>
                <p class="small-text">
                  Esempio di promozioni visualizzate solo ai clienti registrati.
                </p>
                <div id="client-promos" class="list"></div>
              </div>

              <!-- Appuntamenti -->
              <div id="client-panel-appointments" class="client-panel">
                <h3>Appuntamenti</h3>
                <p class="small-text">
                  Se la farmacia offre servizi (ECG, holter, ecc.), in futuro potrai
                  gestire qui le prenotazioni.
                </p>
              </div>

              <!-- Contatti -->
              <div id="client-panel-contacts" class="client-panel">
                <h3>Orari &amp; contatti</h3>
                <ul class="bullet-list">
                  <li>Luned√¨‚ÄìSabato: 08:00‚Äì13:00 ¬∑ 15:00‚Äì20:00</li>
                  <li>Indirizzo: Via ‚Ä¶, Matera</li>
                  <li>Telefono: 0835 ‚Ä¶</li>
                  <li>Email: info@farmaciamontesano.it</li>
                </ul>
              </div>

              <!-- Prossimamente -->
              <div id="client-panel-soon" class="client-panel">
                <h3>Prossimamente‚Ä¶</h3>
                <p>Nuovi servizi digitali dedicati ai clienti in arrivo.</p>
              </div>
            </div>
          </div>
        </div>
      </section>
    </main>
  </div>

  <!-- SCRIPT -->
  <script src="script.js"></script>
</body>
</html>
